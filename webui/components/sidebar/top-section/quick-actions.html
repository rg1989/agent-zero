<html>

<head>
  <script type="module">
    import { store as chatsStore } from "/components/sidebar/chats/chats-store.js";
    import { store as projectsStore } from "/components/projects/projects-store.js";
    import { store as sidebarStore } from "/components/sidebar/sidebar-store.js";
  </script>
</head>

<body>
  <div class="wrapper" x-data="{ dropdownOpen: false }" @click.outside="dropdownOpen = false" @keydown.escape.window="dropdownOpen = false" x-init="$watch('dropdownOpen', v => v && $store.sidebar.updateDropdownPosition($el))">
    <div id="quick-actions">
      <!-- Dashboard -->
      <button class="config-button" id="dashboard" @click="deselectChat()" title="Dashboard"
              x-data="{ hoverColor: '' }" @mouseenter="hoverColor = globalThis.getRandomNeonColor()" @mouseleave="hoverColor = ''"
              :style="hoverColor ? `background-color: var(--color-background-hover); z-index: 1; position: relative;` : ''">
        <span class="material-symbols-outlined" :style="hoverColor ? `color: ${hoverColor}; text-shadow: 0 0 8px ${hoverColor}80;` : ''">home</span>
      </button>

      <!-- Memory -->
      <button class="config-button" id="memory-dash" @click="openModal('modals/memory/memory-dashboard.html')" title="Memory"
              x-data="{ hoverColor: '' }" @mouseenter="hoverColor = globalThis.getRandomNeonColor()" @mouseleave="hoverColor = ''"
              :style="hoverColor ? `background-color: var(--color-background-hover); z-index: 1; position: relative;` : ''">
        <span class="material-symbols-outlined" :style="hoverColor ? `color: ${hoverColor}; text-shadow: 0 0 8px ${hoverColor}80;` : ''">psychology</span>
      </button>

      <!-- Scheduler -->
      <button class="config-button" id="scheduler" @click="openModal('modals/scheduler/scheduler-modal.html')" title="Scheduler"
              x-data="{ hoverColor: '' }" @mouseenter="hoverColor = globalThis.getRandomNeonColor()" @mouseleave="hoverColor = ''"
              :style="hoverColor ? `background-color: var(--color-background-hover); z-index: 1; position: relative;` : ''">
        <span class="material-symbols-outlined" :style="hoverColor ? `color: ${hoverColor}; text-shadow: 0 0 8px ${hoverColor}80;` : ''">schedule</span>
      </button>

      <!-- Settings -->
      <button class="config-button" id="settings" @click="openModal('settings/settings.html')" title="Settings"
              x-data="{ hoverColor: '' }" @mouseenter="hoverColor = globalThis.getRandomNeonColor()" @mouseleave="hoverColor = ''"
              :style="hoverColor ? `background-color: var(--color-background-hover); z-index: 1; position: relative;` : ''">
        <span class="material-symbols-outlined" :style="hoverColor ? `color: ${hoverColor}; text-shadow: 0 0 8px ${hoverColor}80;` : ''">settings</span>
      </button>

      <!-- Dropdown Toggle -->
      <button class="config-button dropdown-toggle" @click="dropdownOpen = !dropdownOpen" title="More options"
              x-data="{ hoverColor: '' }" @mouseenter="hoverColor = globalThis.getRandomNeonColor()" @mouseleave="hoverColor = ''"
              :style="hoverColor ? `background-color: var(--color-background-hover); z-index: 1; position: relative;` : ''">
        <span class="material-symbols-outlined" :class="dropdownOpen ? 'rotated' : ''" :style="hoverColor ? `color: ${hoverColor}; text-shadow: 0 0 8px ${hoverColor}80;` : ''">expand_more</span>
      </button>
    </div>

    <!-- Dropdown Menu -->
    <div class="dropdown-menu quick-actions-dropdown" 
         x-show="dropdownOpen"
         :style="$store.sidebar.dropdownStyle">
      
      <div class="dropdown-header">Navigation</div>
      
      <button class="dropdown-item dd-dashboard" x-data="{ hoverColor: '' }" @mouseenter="hoverColor = globalThis.getRandomNeonColor()" @mouseleave="hoverColor = ''" @click="deselectChat(); dropdownOpen = false"
              :style="hoverColor ? `background-color: ${hoverColor}20;` : ''">
        <span class="material-symbols-outlined" :style="hoverColor ? `color: ${hoverColor};` : ''">home</span>
        <span :style="hoverColor ? `color: ${hoverColor};` : ''">Dashboard</span>
      </button>

      <button class="dropdown-item dd-projects" x-data="{ hoverColor: '' }" @mouseenter="hoverColor = globalThis.getRandomNeonColor()" @mouseleave="hoverColor = ''" @click="$store.projects.openProjectsModal(); dropdownOpen = false"
              :style="hoverColor ? `background-color: ${hoverColor}20;` : ''">
        <span class="material-symbols-outlined" :style="hoverColor ? `color: ${hoverColor};` : ''">snippet_folder</span>
        <span :style="hoverColor ? `color: ${hoverColor};` : ''">Projects</span>
      </button>
      
      <button class="dropdown-item dd-memories" x-data="{ hoverColor: '' }" @mouseenter="hoverColor = globalThis.getRandomNeonColor()" @mouseleave="hoverColor = ''" @click="openModal('modals/memory/memory-dashboard.html'); dropdownOpen = false"
              :style="hoverColor ? `background-color: ${hoverColor}20;` : ''">
        <span class="material-symbols-outlined" :style="hoverColor ? `color: ${hoverColor};` : ''">psychology</span>
        <span :style="hoverColor ? `color: ${hoverColor};` : ''">Memories</span>
      </button>
      
      <button class="dropdown-item dd-scheduler" x-data="{ hoverColor: '' }" @mouseenter="hoverColor = globalThis.getRandomNeonColor()" @mouseleave="hoverColor = ''" @click="openModal('modals/scheduler/scheduler-modal.html'); dropdownOpen = false"
              :style="hoverColor ? `background-color: ${hoverColor}20;` : ''">
        <span class="material-symbols-outlined" :style="hoverColor ? `color: ${hoverColor};` : ''">schedule</span>
        <span :style="hoverColor ? `color: ${hoverColor};` : ''">Scheduler</span>
      </button>
      
      <button class="dropdown-item dd-settings" x-data="{ hoverColor: '' }" @mouseenter="hoverColor = globalThis.getRandomNeonColor()" @mouseleave="hoverColor = ''" @click="openModal('settings/settings.html'); dropdownOpen = false"
              :style="hoverColor ? `background-color: ${hoverColor}20;` : ''">
        <span class="material-symbols-outlined" :style="hoverColor ? `color: ${hoverColor};` : ''">settings</span>
        <span :style="hoverColor ? `color: ${hoverColor};` : ''">Settings</span>
      </button>
      
      <div class="dropdown-separator"></div>
      <div class="dropdown-header">Chat Actions</div>
      
      <button class="dropdown-item dd-new-chat" x-data="{ hoverColor: '' }" @mouseenter="hoverColor = globalThis.getRandomNeonColor()" @mouseleave="hoverColor = ''" @click="$store.chats.newChat(); dropdownOpen = false"
              :style="hoverColor ? `background-color: ${hoverColor}20;` : ''">
        <span class="material-symbols-outlined" :style="hoverColor ? `color: ${hoverColor};` : ''">edit_square</span>
        <span :style="hoverColor ? `color: ${hoverColor};` : ''">New Chat</span>
      </button>
      
      <button class="dropdown-item dd-load-chat" x-data="{ hoverColor: '' }" @mouseenter="hoverColor = globalThis.getRandomNeonColor()" @mouseleave="hoverColor = ''" @click="$store.chats.loadChats(); dropdownOpen = false"
              :style="hoverColor ? `background-color: ${hoverColor}20;` : ''">
        <span class="material-symbols-outlined" :style="hoverColor ? `color: ${hoverColor};` : ''">folder_open</span>
        <span :style="hoverColor ? `color: ${hoverColor};` : ''">Load Chat</span>
      </button>
      
      <button class="dropdown-item dd-save-chat" x-data="{ hoverColor: '' }" @mouseenter="hoverColor = globalThis.getRandomNeonColor()" @mouseleave="hoverColor = ''" @click="$store.chats.saveChat(); dropdownOpen = false" :disabled="!$store.chats.selected"
              :style="hoverColor ? `background-color: ${hoverColor}20;` : ''">
        <span class="material-symbols-outlined" :style="hoverColor ? `color: ${hoverColor};` : ''">save</span>
        <span :style="hoverColor ? `color: ${hoverColor};` : ''">Save Chat</span>
      </button>

      <button class="dropdown-item dd-clear-chat" x-data="{ hoverColor: '' }" @mouseenter="hoverColor = globalThis.getRandomNeonColor()" @mouseleave="hoverColor = ''" @click="$confirmClick($event, () => { $store.chats.resetChat(); dropdownOpen = false })" :disabled="!$store.chats.selected"
              :style="hoverColor ? `background-color: ${hoverColor}20;` : ''">
        <span class="material-symbols-outlined" :style="hoverColor ? `color: ${hoverColor};` : ''">delete_sweep</span>
        <span :style="hoverColor ? `color: ${hoverColor};` : ''">Clear Chat</span>
      </button>
      
      <div class="dropdown-separator"></div>
      
      <button class="dropdown-item dd-logout" x-data="{ hoverColor: '' }" @mouseenter="hoverColor = globalThis.getRandomNeonColor()" @mouseleave="hoverColor = ''" @click="$confirmClick($event, () => { $store.chats.logout(); dropdownOpen = false })" :disabled="!$store.chats.loggedIn"
              :style="hoverColor ? `background-color: ${hoverColor}20;` : ''">
        <span class="material-symbols-outlined" :style="hoverColor ? `color: ${hoverColor};` : ''">logout</span>
        <span :style="hoverColor ? `color: ${hoverColor};` : ''">Logout</span>
      </button>

      <button class="dropdown-item dd-restart" x-data="{ hoverColor: '' }" @mouseenter="hoverColor = globalThis.getRandomNeonColor()" @mouseleave="hoverColor = ''" @click="$confirmClick($event, () => { $store.chats.restart(); dropdownOpen = false })"
              :style="hoverColor ? `background-color: ${hoverColor}20;` : ''">
        <span class="material-symbols-outlined" :style="hoverColor ? `color: ${hoverColor};` : ''">restart_alt</span>
        <span :style="hoverColor ? `color: ${hoverColor};` : ''">Restart A0</span>
      </button>

    </div>
  </div>
</body>

<style>
  /* Wrapper container for icon toolbar */
  .wrapper {
    position: relative;
    border-radius: 0.6rem;
    z-index: 100;
    flex: 1;
    min-width: 0;
    /* Ensure dropdown appears above all sidebar content */
  }

  /* Icon toolbar layout */
  #quick-actions {
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    width: 100%;
    justify-content: space-between;
    padding: 0;
    gap: 0;
  }

  /* Config button - icon only style */
  .config-button {
    background-color: var(--color-panel);
    border: 0.05rem solid var(--color-border);
    border-radius: 6px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0.8;
    padding: var(--spacing-xs);
    flex: 1;
    min-width: 0;
    transition: all var(--transition-speed), transform 0.1s ease-in-out;
  }

  .config-button .material-symbols-outlined {
    font-size: 22px;
    transition: transform 0.2s ease;
  }

  .config-button .material-symbols-outlined.rotated {
    transform: rotate(180deg);
  }

  /* Connected button borders */
  .config-button:not(:last-child) {
    margin-right: -1px;
    border-right: 1px solid var(--color-border);
  }

  .config-button:first-child {
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
  }

  .config-button:last-child {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
  }

  .config-button:not(:first-child):not(:last-child) {
    border-radius: 0;
  }

  .config-button:hover {
    background-color: var(--color-background-hover);
    opacity: 1;
    z-index: 1;
    position: relative;
  }

  .config-button:active {
    opacity: 0.5;
    transform: scale(0.95);
  }

  /* Dropdown specific positioning - fixed to escape overflow:hidden */
  .quick-actions-dropdown {
    position: fixed;
    z-index: 9999;
  }

  /* Unified scrollbar styling for dropdown */
  .quick-actions-dropdown::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }

  .quick-actions-dropdown::-webkit-scrollbar-track {
    background: transparent;
    margin: 4px 0;
    border-radius: 6px;
  }

  .quick-actions-dropdown::-webkit-scrollbar-thumb {
    background-color: rgba(155, 155, 155, 0.5);
    border-radius: 6px;
    transition: background-color 0.2s ease;
  }

  .quick-actions-dropdown::-webkit-scrollbar-thumb:hover {
    background-color: rgba(155, 155, 155, 0.7);
  }

  /* Dropdown item icon sizing */
  .dropdown-item .material-symbols-outlined {
    font-size: 18px;
  }

  /* Dropdown items: distinct default colors (dark mode) */
  .dd-dashboard .material-symbols-outlined, .dd-dashboard > span:last-child { color: #00f2fe; }
  .dd-projects .material-symbols-outlined, .dd-projects > span:last-child { color: #3a86ff; }
  .dd-memories .material-symbols-outlined, .dd-memories > span:last-child { color: #bf00ff; }
  .dd-scheduler .material-symbols-outlined, .dd-scheduler > span:last-child { color: #ffb86c; }
  .dd-settings .material-symbols-outlined, .dd-settings > span:last-child { color: #00ff9d; }
  .dd-new-chat .material-symbols-outlined, .dd-new-chat > span:last-child { color: #00f2fe; }
  .dd-load-chat .material-symbols-outlined, .dd-load-chat > span:last-child { color: #3a86ff; }
  .dd-save-chat .material-symbols-outlined, .dd-save-chat > span:last-child { color: #00ff9d; }
  .dd-clear-chat .material-symbols-outlined, .dd-clear-chat > span:last-child { color: #ff007f; }
  .dd-logout .material-symbols-outlined, .dd-logout > span:last-child { color: #ff007f; }
  .dd-restart .material-symbols-outlined, .dd-restart > span:last-child { color: #ffb86c; }

  /* New Chat Button */
  #newChat {
  display: flex;
  flex-wrap: nowrap;
  background-color: transparent;
  border: none;
  align-items: center;
  opacity: 0.6;
  cursor: pointer;
  -webkit-transition: all 0.1s ease-in-out, left var(--transition-speed) ease-in-out;
  transition: all 0.1s ease-in-out, left var(--transition-speed) ease-in-out;
  }
  #newChat:hover { opacity: 0.85; transform: scale(1.04); }
  #newChat:active { opacity: 0.5; transform: scale(0.98); }
  #newChat .material-symbols-outlined { 
    color: var(--color-text); 
    font-size: 24px;
  }

  /* Light mode */
  .light-mode .config-button {
    background-color: var(--color-background);
    color: #333333;
  }

  .light-mode .config-button:hover { background-color: var(--color-background-hover); }
  .light-mode .config-button:active { background-color: var(--color-background-hover); }

  /* Dark mode: give each icon its own neon color */
  #dashboard .material-symbols-outlined { color: #00f2fe; }
  #memory-dash .material-symbols-outlined { color: #bf00ff; }
  #scheduler .material-symbols-outlined { color: #ffb86c; }
  #settings .material-symbols-outlined { color: #00ff9d; }
  .dropdown-toggle .material-symbols-outlined { color: #3a86ff; }

  /* Light mode: give each icon its own default color */
  .light-mode #dashboard .material-symbols-outlined { color: #1565c0; }
  .light-mode #memory-dash .material-symbols-outlined { color: #7b1fa2; }
  .light-mode #scheduler .material-symbols-outlined { color: #e65100; }
  .light-mode #settings .material-symbols-outlined { color: #2e7d32; }
  .light-mode .dropdown-toggle .material-symbols-outlined { color: #546e7a; }

  /* Transition helpers */
  .-translate-y-1 { transform: translateY(-0.25rem); }
  .translate-y-0 { transform: translateY(0); }
</style>

</html>
